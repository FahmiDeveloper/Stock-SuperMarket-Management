<h3 *ngIf="!anime.key" mat-dialog-title>Add new anime</h3>
<h3 *ngIf="anime.key" mat-dialog-title>Edit anime</h3>

<div class="row">
    <div class="col-md-12">
        <form (ngSubmit)="save()" #f="ngForm">

            <mat-form-field color="accent" style="width: 305px;">
                <mat-placeholder class="text-application"><span>Name</span></mat-placeholder>
                <input matInput #input type="text" [(ngModel)]="anime.nameAnime" name="nameAnime" required>
                <mat-error *ngIf="f.invalid">{{getErrorMessage()}}</mat-error>
            </mat-form-field>

            <div class="row">
                <div class="col-md-4">
    
                    <mat-form-field color="accent" style="width: 105px;">
                        <mat-placeholder class="text-application"><span>Date</span></mat-placeholder>
                        <input matInput #input type="date" [(ngModel)]="anime.date" name="date" readonly>
                        <mat-error *ngIf="f.invalid">{{getErrorMessage()}}</mat-error>
                    </mat-form-field>

                    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

                    <mat-checkbox name="isFirst" [(ngModel)]="anime.isFirst" class="mat-checkbox-layout"><span>First</span></mat-checkbox>

                </div>
            </div>
    
            <mat-form-field color="accent" style="width: 305px;">
                <mat-placeholder class="text-application"><span>Status</span></mat-placeholder>
                <mat-select [(ngModel)]="anime.statusId" name="statusId" required>
                    <mat-option value=""></mat-option>
                    <mat-option *ngFor="let statusAnime of statusAnimes" [value]="statusAnime.id">
                        {{statusAnime.status}}
                    </mat-option>
                </mat-select>
                <mat-error *ngIf="f.invalid">{{getErrorMessage()}}</mat-error>
            </mat-form-field>

            <div class="row">
                <div class="col-md-4">
                    <mat-form-field color="accent" style="width: 100px;">
                        <mat-placeholder class="text-application"><span>Type</span></mat-placeholder>
                          <mat-select [(ngModel)]="anime.type" name="type">
                            <mat-option value="Manga">Manga</mat-option>
                            <mat-option value="TV">TV</mat-option>
                            <mat-option value="Movie">Movie</mat-option>
                            <mat-option value="Special">Special</mat-option>
                          </mat-select>
                      </mat-form-field>

                    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

                    <mat-form-field color="accent" style="width: 100px;">
                        <mat-placeholder class="text-application"><span>Priority</span></mat-placeholder>
                        <input matInput #input type="number" [(ngModel)]="anime.priority" name="priority" class="text-application">
                    </mat-form-field>
                </div>
            </div>

            <div class="row" *ngIf="anime.type == 'TV'">
                <div class="col-md-4">

                    <mat-form-field color="accent" style="width: 100px;">
                        <mat-placeholder class="text-application"><span>Curr ep</span></mat-placeholder>
                        <input matInput #input type="text" [(ngModel)]="anime.currentEpisode" name="currentEpisode">
                    </mat-form-field>

                    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

                    <mat-form-field color="accent" style="width: 100px;">
                        <mat-placeholder class="text-application"><span>Total ep</span></mat-placeholder>
                        <input matInput #input type="text" [(ngModel)]="anime.totalEpisodes" name="totalEpisodes">
                    </mat-form-field>

                </div>
            </div>

            <div class="row" *ngIf="anime.type == 'TV'">
                <div class="col-md-4">

                    <mat-form-field color="accent" style="width: 100px;">
                        <mat-placeholder class="text-application"><span>Season</span></mat-placeholder>
                        <input matInput #input type="text" [(ngModel)]="anime.season" name="season">
                    </mat-form-field>

                </div>
            </div>
    
            <mat-form-field color="accent" style="width: 305px;">
                <textarea matInput #input type="text" placeholder="Note" [(ngModel)]="anime.note" name="note" rows="4" cols="40"></textarea>
            </mat-form-field>
    
            <mat-form-field *ngIf="anime.statusId && (anime.statusId == 1 || anime.statusId == 2)" color="accent" style="width: 305px;">
                <textarea matInput #input type="text" placeholder="Path" [(ngModel)]="anime.path" name="path" rows="4" cols="40"></textarea>
            </mat-form-field>
    
            <mat-form-field style="width: 305px;">
                <input matInput #input [(ngModel)]="anime.imageUrl" name="imageUrl" id="imageUrl" type="text" hidden>
                <input type="file" name="file" (input)="onFileChanged($event)" accept=".jpeg,.jpg,.png,.svg">
            </mat-form-field>
    
            <br>

            <div *ngIf="progressValue | async as val" class="progress-background">
              <div class="progress-meter" [ngStyle] = "{'width.%': val}"></div>
            </div>
            <div *ngIf="progressValue | async as val" class="progress-indicator" [ngStyle] = "{'margin-left.%': val-3}">
                <i class="fa fa-caret-up"></i>
                <div>
                    <i class="fa fa-motorcycle" style="font-size:24px "></i>
                </div>
                <span>{{ val | number }}%</span>
            </div>

            <div class="row justify-content-center" mat-dialog-actions>
                <button mat-button type="submit" [disabled]="!f.valid" [mat-dialog-close]="1" style="background:#FF5722;color: white;">Save</button>
                <button mat-button type="button" (click)="close()" tabindex="-1" style="background:#607D8B;color: white;">Cancel</button>
            </div>
        
        </form>
    </div>
</div>