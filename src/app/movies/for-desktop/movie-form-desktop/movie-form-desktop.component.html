<div class="container">
    <h3 *ngIf="!movie.key" mat-dialog-title class="text-application">Add new movie</h3>
    <h3 *ngIf="movie.key" mat-dialog-title class="text-application">Edit movie</h3>
  
    <div class="row">
      <div class="col-md-6">
        <form (ngSubmit)="save()" #f="ngForm">
  
          <div class="form">
            <mat-form-field color="accent">
              <mat-placeholder class="text-application"><span>Name</span></mat-placeholder>
              <input matInput #input type="text" [(ngModel)]="movie.nameMovie" name="nameMovie" required class="text-application">
              <mat-error *ngIf="f.invalid" class="text-application">{{getErrorMessage()}}</mat-error>
            </mat-form-field>
          </div>
      
          <div class="form">
            <mat-form-field color="accent">
              <mat-placeholder class="text-application"><span>Date</span></mat-placeholder>
              <input matInput #input type="date" [(ngModel)]="movie.date" name="date" readonly class="text-application">
              <mat-error *ngIf="f.invalid" class="text-application">{{getErrorMessage()}}</mat-error>
            </mat-form-field>
          </div>
      
          <div class="form">
            <mat-form-field color="accent">
              <mat-placeholder class="text-application"><span>Status</span></mat-placeholder>
              <mat-select [(ngModel)]="movie.statusId" name="statusId" required class="text-application">
                <mat-option value=""></mat-option>
                <mat-option *ngFor="let statusMovie of statusMovies" [value]="statusMovie.id">
                  <span class="text-application">{{statusMovie.status}}</span>
                </mat-option>
              </mat-select>
              <mat-error *ngIf="f.invalid" class="text-application">{{getErrorMessage()}}</mat-error>
            </mat-form-field>
          </div>
  
          <div class="form row">
            <div class="col-md-4">
              <mat-form-field color="accent" style="width: 100px;">
                <mat-placeholder class="text-application"><span>Part</span></mat-placeholder>
                <input matInput #input type="number" [(ngModel)]="movie.part" name="part" class="text-application">
              </mat-form-field>
            </div>
            <div class="col-md-4">
              <div style="margin-top: 20px;">
                <mat-checkbox name="isFirst" [(ngModel)]="movie.isFirst" class="mat-checkbox-layout"><span>First</span></mat-checkbox>
              </div>
            </div>           
          </div>
  
          <div class="form row">
            <div class="col-md-4">
              <mat-form-field color="accent" style="width: 100px;">
                <mat-placeholder class="text-application"><span>Priority</span></mat-placeholder>
                <input matInput #input type="number" [(ngModel)]="movie.priority" name="priority" class="text-application">
              </mat-form-field>
            </div>
            <div class="col-md-4">
              <mat-form-field color="accent" style="width: 100px;">
                <mat-placeholder class="text-application"><span>Year</span></mat-placeholder>
                <mat-select [(ngModel)]="movie.year" name="year" class="text-application">
                    <mat-option value=""></mat-option>
                    <mat-option *ngFor="let year of years" [value]="year">
                      <span class="text-application">{{year}}</span>
                    </mat-option>
                </mat-select>
              </mat-form-field>
            </div>           
          </div>
  
          <div class="form" *ngIf="movie.part">
            <mat-form-field color="accent">
              <mat-placeholder class="text-application"><span>Full Name</span></mat-placeholder>
              <input matInput #input type="text" [(ngModel)]="movie.fullNameMovie" name="fullNameMovie" required class="text-application">
              <mat-error *ngIf="f.invalid" class="text-application">{{getErrorMessage()}}</mat-error>
            </mat-form-field>
          </div>
    
          <div class="form">
            <mat-form-field color="accent">
              <mat-placeholder class="text-application"><span>Note</span></mat-placeholder>
              <textarea matInput #input type="text" [(ngModel)]="movie.note" name="note" rows="4" cols="40" class="text-application"></textarea>
            </mat-form-field>
          </div>
    
          <div class="form" *ngIf="movie.statusId && (movie.statusId == 1 || movie.statusId == 2)">
            <mat-form-field color="accent">
              <mat-placeholder class="text-application"><span>Path</span></mat-placeholder>
              <input matInput #input type="text" [(ngModel)]="movie.path" name="path" class="text-application">
            </mat-form-field>
          </div>
    
          <div class="form">
            <input matInput #input [(ngModel)]="movie.imageUrl" name="imageUrl" id="imageUrl" type="text" hidden>
            <input type="file" name="file" (input)="onFileChanged($event)" accept=".jpeg,.jpg,.png,.svg">
          </div>
  
          <br>
  
          <div *ngIf="progressValue | async as val" class="progress-background">
            <div class="progress-meter" [ngStyle] = "{'width.%': val}"></div>
          </div>
          <div *ngIf="progressValue | async as val" class="progress-indicator" [ngStyle] = "{'margin-left.%': val-3}">
              <i class="fa fa-caret-up"></i>
              <div>
                  <i class="fa fa-motorcycle" style="font-size:24px "></i>
              </div>
              <span>{{ val | number }}%</span>
          </div>
      
          <div class="row justify-content-center" mat-dialog-actions>
            <button mat-button type="submit" [disabled]="!f.valid" [mat-dialog-close]="1" style="background:#FF5722;color: white;" class="text-application">Save</button>
            <button mat-button type="button" (click)="close()" tabindex="-1" style="background:#607D8B;color: white;" class="text-application">Cancel</button>
          </div>
      
        </form>
      </div>
      <div class="col-md-6">
        <div class="row justify-content-center">
          <mat-card class="example-card">
              <img *ngIf="movie.imageUrl" mat-card-image [src]="movie.imageUrl" class="stylePicture">
              <img *ngIf="!movie.imageUrl" mat-card-image src="/assets/pictures/NoImageAvailable.png" class="stylePicture">
          </mat-card>
        </div>
      </div>
    </div>
  </div>