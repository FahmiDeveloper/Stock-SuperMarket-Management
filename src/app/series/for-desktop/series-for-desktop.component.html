<h1 class="titleTextInterface text-application">Series</h1>

<div class="row">
    <div class="col-md-3">
        <mat-form-field class="widthInput">
            <mat-label class="text-application">Name</mat-label>
            <input matInput type="text" name="serieName" (keyup)="getAllSeries()" [(ngModel)]="serieName"/>
        </mat-form-field>
    </div>
    <div class="col-md-3">
        <mat-form-field class="widthInput">
            <mat-label class="text-application">Status</mat-label>
			<mat-select name="statusId" [(ngModel)]="statusId" (selectionChange)="getAllSeries()" class="text-application">
                <mat-option value=""></mat-option>
				<mat-option *ngFor="let statusSerie of statusSeries" [value]="statusSerie.id">
                    <span class="text-application">{{statusSerie.status}}</span>
				</mat-option>
			</mat-select>
		</mat-form-field>
    </div>
    <div class="col-md-2">
        <ng-container *ngIf="statusId">
            <mat-form-field class="widthInput" *ngIf="statusId == 1">
                <mat-select [(ngModel)]="optionSelected" name="optionSelected" class="text-application" (selectionChange)="getAllSeries()">
                    <mat-option value=""></mat-option>
                    <mat-option [value]="1" class="text-application">Not yet aired</mat-option>
                    <mat-option [value]="2" class="text-application">{{nbrSeriesToCheckToday}}&nbsp;serie(s) to check Today</mat-option>
                </mat-select>
            </mat-form-field>
    
            <mat-checkbox *ngIf="statusId == 3" name="dislike" [(ngModel)]="dislike" (ngModelChange)="getAllSeries()" class="mat-checkbox-layout" style="margin-top: 10%;">
                <span class="text-application">Dislike</span>
            </mat-checkbox>
        </ng-container> 
    </div>
    <div class="col-md-2"></div>
    <div class="col-md-2">
        <button
            type="button" 
            (click)="newSerie()" 
            mat-mini-fab 
            color="primary" 
            style="background: #2196F3;float: right;">
            <mat-icon style="color: white;">add</mat-icon>
        </button>
    </div> 
</div>

<br>

<ng-container *ngFor="let serie of (seriesList | paginate: { itemsPerPage: 6 , currentPage: p })">
    
    <mat-card appMaterialElevation [defaultElevation]="defaultElevation" raisedElevation="16">

        <mat-grid-list cols="4" rowHeight="250px">

            <mat-grid-tile>
                <img *ngIf="serie.imageUrl" [src]="serie.imageUrl" class="serie-image">
                <img *ngIf="!serie.imageUrl" src="/assets/pictures/NoImageAvailable.png" class="serie-image">
            </mat-grid-tile>

            <mat-grid-tile class="center-name-serie">
                <h1 class="text-application" style="cursor: pointer;" (click)="copyText(serie.nameSerie)">{{ serie.nameSerie }}</h1>
            </mat-grid-tile>

            <mat-grid-tile class="text-application">

                <div style="width:100%;">

                    <div class="gridForLegend" style="width:70%; height:100%; margin: auto; margin-top: 1em; margin-bottom: 1em;">
                        <div><dt>Year</dt></div>
                        <div></div>
                        <div>
                            <span *ngIf="serie.year">{{ serie.year }}</span>
                            <span *ngIf="!serie.year">?</span>
                        </div>
                    </div>

                    <div *ngIf="!serie.notLiked" class="gridForLegend" style="width:70%; height:100%; margin: auto; margin-top: 1em; margin-bottom: 1em;">
                        <div><dt>Season</dt></div>
                        <div></div>
                        <div>
                            <span *ngIf="serie.season">{{ serie.season }}</span>
                            <span *ngIf="!serie.season">?</span> 
                        </div>
                    </div>

                    <div class="gridForLegend" style="width:70%; height:100%; margin: auto; margin-top: 1em; margin-bottom: 1em;">
                        <div><dt>Status</dt></div>
                        <div></div>
                        <div>
                            <i *ngIf="serie.statusId == 1" class="fa fa-2x fa-spinner fa-spin" style="color:goldenrod;"></i>
                            <i *ngIf="serie.statusId == 2" class="fa fa-2x fa-download" style="color: red;"></i>
                            <i *ngIf="serie.statusId == 3 && !serie.notLiked" class="fa fa-2x fa-eye" style="color: green;"></i>
                            <i *ngIf="serie.statusId == 4" class="fa fa-2x fa-eye" style="color: red;"></i>
                            <i *ngIf="serie.statusId == 5" class="fa fa-2x fa-search" style="color:#07609b;"></i>
                            <i *ngIf="serie.notLiked" class="fa fa-2x fa-thumbs-down" style="color: red;"></i>
                        </div>
                    </div>

                    <div *ngIf="serie.statusId == 1" class="gridForLegend" style="width:70%; height:100%; margin: auto; margin-top: 1em; margin-bottom: 1em;">
                        <div><dt>Check</dt></div>
                        <div></div>
                        <div style="width: 140%;">
                            <span *ngIf="serie.checkDate">{{ serie.checkDate | date: 'd MMM y' }}</span>
                            <span *ngIf="!serie.checkDate">?</span>
                        </div>
                    </div>

                    <div *ngIf="!serie.notLiked && serie.statusId !== 3" class="gridForLegend" style="width:70%; height:100%; margin: auto; margin-top: 1em; margin-bottom: 1em;">
                        <div><dt>Curr/Tot</dt></div>
                        <div></div>
                        <div>
                            <span *ngIf="serie.currentEpisode">{{ serie.currentEpisode }}</span>
                            <span *ngIf="!serie.currentEpisode">?</span>
                            /
                            <span *ngIf="serie.totalEpisodes">{{ serie.totalEpisodes }}</span>
                            <span *ngIf="!serie.totalEpisodes">?</span>   
                        </div>
                    </div>
                    
                    <div class="gridForLegend" style="width:70%; height:100%; margin: auto; margin-top: 1em; margin-bottom: 1em;">
                        <div><dt>Note</dt></div>
                        <div></div>
                        <div>
                            <mat-icon *ngIf="serie.note" style="color: black;" style="cursor: pointer;" (click)="viewNote(serie.note)">note</mat-icon>         
                            <i *ngIf="!serie.note" class="fa fa-minus-circle"></i>
                        </div>
                    </div> 

                </div>          

            </mat-grid-tile>

            <mat-grid-tile>

                <button
                    *ngIf="!statusId && serie.season && serie.season == 1" 
                    type="button"
                    mat-button 
                    (click)="showDetailsSerie(serie)"
                    class="style-button text-application center-btn">
                    <mat-icon style="color: #a54403">view_list</mat-icon>
                    <span>Seasons</span>
                </button>

                <button 
                    *ngIf="statusId || !serie.season || (serie.season && serie.season > 1)"
                    type="button"
                    mat-button
                    [matMenuTriggerFor]="menu" 
                    class="style-button text-application center-btn">
                    <mat-icon style="color: #07609b">calendar_view_day</mat-icon>
                    Actions
                </button>

                <mat-menu #menu="matMenu" class="my-menu" xPosition="before">
                    <button
                        mat-menu-item 
                        class="text-application"
                        (click)="editSerie(serie)">
                        <mat-icon style="color: #9C27B0">edit</mat-icon>
                        Edit
                    </button>
                    <button
                        *ngIf="serie.statusId == 1 && serie.path" 
                        mat-menu-item 
                        class="text-application"
                        (click)="followLink(serie.path)">
                        <mat-icon style="color: #3f51b5">remove_red_eye</mat-icon>
                        Check
                    </button>
                    <button
                        *ngIf="serie.statusId == 2 && serie.path"  
                        mat-menu-item 
                        class="text-application"
                        (click)="followLink(serie.path)">
                        <mat-icon style="color: green">cloud_download</mat-icon>
                        Download
                    </button>
                    <button
                        *ngIf="serie.statusId == 4 && serie.path"  
                        mat-menu-item 
                        class="text-application"
                        (click)="followLink(serie.path)">
                        <mat-icon style="color: #3f51b5">remove_red_eye</mat-icon>
                        Watch
                    </button>
                    <button
                        *ngIf="serie.statusId == 5 && serie.path"  
                        mat-menu-item 
                        class="text-application"
                        (click)="followLink(serie.path)">
                        <mat-icon style="color: #0e8999">search</mat-icon>
                        Search
                    </button>
                    <button
                        mat-menu-item 
                        class="text-application"
                        (click)="deleteSerie(serie.key)">
                        <mat-icon style="color: #f44336;">delete</mat-icon>
                        Delete
                    </button>
                </mat-menu>   

            </mat-grid-tile>

        </mat-grid-list>
       
    </mat-card>

    <br>

</ng-container>

<br>

<div *ngIf="seriesList.length !== 0" class="pagination">
    <pagination-controls (pageChange)="p = $event;OnPageChange($event)"></pagination-controls>
</div>

<div *ngIf="seriesList.length == 0" class="row justify-content-center no-results text-application">
    No results
</div>